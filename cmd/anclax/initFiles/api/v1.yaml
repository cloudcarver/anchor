openapi: 3.0.0

info:
  title: My Anclax Project
  version: "1.0"
  description: API for interacting with my anclax project

servers:
  - url: /api/v1
    description: Base API path

paths:
  /counter:
    get:
      summary: Get Counter
      description: Retrieve the current counter value
      operationId: getCounter
      responses:
        "200":
          description: The current counter value
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Counter"
      security: []
    post:
      summary: Increment Counter
      description: Increment the counter by a specified amount
      operationId: incrementCounter
      responses:
        "202":
          description: The increment was accepted
      security: 
        - BearerAuth: 
            - x.OperationPermit(c, operationID)

components:
  schemas:
    Counter:
      type: object
      required: [count]
      properties:
        count:
          type: integer
          format: int32

x-check-rules:
  OperationPermit:
    description: Check if the user has permission to perform the operation
    useContext: true
    parameters:
      - name: operationID
        description: The operation ID
        schema:
          type: string
